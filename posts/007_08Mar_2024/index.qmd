---
title: "Simpson's Paradox - A Simple Explanation"
date: 2024-03-08
categories: [concept, code, visualisation]
image: "R_small.jpeg"
description: "Simpson's Paradox is essentially an extreme form of confounding, characterised by a reversal of the effect estimate sign."
---

For this - have 3 groups - honours, masters and PhD's. Have aggregated slope of cups of coffee vs words per minute typing being negative, but then disaggregated slope being positive within each group. Honours students will have highest WPM because by the time you get to being a PhD, you're exhausted and have typing-related RSI...

```{r}
#| label: setup
#| message: false
library(bayestestR)
library(ggplot2)

# Simulate some data 
set.seed(253445)
dat <- simulate_simpson(
  n = 50,
  r = -0.5,
  groups = 3,
  difference = 2,
  group_prefix = "G_"
)
dat$V2 <- abs(dat$V2*10)
#dat$V1 <- abs(dat$V1)
```

```{r}
#| label: plot_aggregated
#| message: false
ggplot(dat, aes(x = V1, y = V2)) + 
  geom_point() + 
  theme_bw(base_size = 15)
```

```{r}
#| label: plot_disaggregated
#| message: false
ggplot(dat, aes(x = V1, y = V2, color = Group)) + 
  geom_point() + 
  theme_bw(base_size = 15)
```
