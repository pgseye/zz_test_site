birthwt <- birthwt |>
mutate(age_10 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each decile of maternal age
grouped_dat <- birthwt |>
group_by(age_10) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(prop = `1`/(`0` + `1`),
logodds = qlogis(prop))
# Categorise maternal age into 5 quantiles
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each decile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(prop = `1`/(`0` + `1`),
logodds = qlogis(prop))
str(grouped_dat)
14+19
33/2
20
22.5
26
28+45
73/2
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each decile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(prop = `1`/(`0` + `1`),
logodds = qlogis(prop))
# Take the middle age of each quantile range and bind to data
age_5_mid = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = age_5_mid, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
#scale_x_continuous(limits = c(1, 10), breaks = seq(1, 10, by = 1)) +
xlab("Maternal Age Decile") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(0, 40), breaks = seq(0, 40, by = 5)) +
xlab("Maternal Age Decile") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 40), breaks = seq(15, 40, by = 5)) +
xlab("Maternal Age Decile") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(prop = `1`/(`0` + `1`),
logodds = qlogis(prop))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 40), breaks = seq(15, 40, by = 5)) +
xlab("Maternal Age Decile") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(prop = `1`/(`0` + `1`),
logodds = qlogis(prop))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_10, y = logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(props))
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(obs_props))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
exp(-0.25)
.779/1.779
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(obs_props))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
# Model
mod2 <-  glm(low ~ ns(age,3), family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod2, intercept = T)
newdf2 <-  expand.grid(age = seq(15, 45, by = 5))
newdf2 <-  newdf |>
mutate(pred_logodds = predict(mod2, newdata = newdf2))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(obs_props))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
# Model
mod2 <-  glm(low ~ ns(age,3), family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod2, intercept = T)
#| message: false
#| warning: false
newdf2 <-  expand.grid(age = seq(15, 45, by = 0.5))
newdf2 <-  newdf2 |>
mutate(pred_logodds = predict(mod2, newdata = newdf2))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
anova(mod, mod2)
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(obs_props))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
# Model
mod2 <-  glm(low ~ ns(age,3), family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod2, intercept = T)
#| message: false
#| warning: false
newdf2 <-  expand.grid(age = seq(15, 45, by = 0.5))
newdf2 <-  newdf2 |>
mutate(pred_logodds = predict(mod2, newdata = newdf2))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
newdf2 <-  expand.grid(age = seq(15, 45, by = 0.5))
newdf2 <-  newdf2 |>
mutate(pred_probs = predict(mod2, newdata = newdf2, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
library(tidyverse)
library(splines)
library(gtsummary)
data(birthwt, package = "MASS")
# Model
mod <-  glm(low ~ age, family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod, intercept = T)
# Categorise maternal age into 5 quantiles (could make this more or less)
birthwt <- birthwt |>
mutate(age_5 = cut_number(age, 5))
# Proportion of women with low birthweight babies in each quantile of maternal age
grouped_dat <- birthwt |>
group_by(age_5) |>
count(low) |>
pivot_wider(names_from = low,
values_from = n) |>
mutate(obs_props = `1`/(`0` + `1`),
obs_logodds = qlogis(obs_props))
# Take the middle age of each quantile range and bind to data
vec = c(16.5, 20, 22.5, 26, 36.5)
grouped_dat <-  cbind("age_5_mid" = vec, grouped_dat)
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age") + ylab("Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_logodds = predict(mod, newdata = newdf))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
newdf <-  expand.grid(age = seq(15, 45, by = 5))
newdf <-  newdf |>
mutate(pred_probs = predict(mod, newdata = newdf, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
# Model
mod2 <-  glm(low ~ ns(age,3), family = "binomial", data = subset(birthwt, age < 40))
tbl_regression(mod2, intercept = T)
#| message: false
#| warning: false
newdf2 <-  expand.grid(age = seq(15, 45, by = 0.5))
newdf2 <-  newdf2 |>
mutate(pred_logodds = predict(mod2, newdata = newdf2))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_logodds)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_logodds)) +
scale_y_continuous(limits = c(-2, 0), breaks = seq(-2, 0, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Log-odds of Low Birthweight") +
theme_bw(base_size = 20)
#| message: false
#| warning: false
newdf2 <-  expand.grid(age = seq(15, 45, by = 0.5))
newdf2 <-  newdf2 |>
mutate(pred_probs = predict(mod2, newdata = newdf2, type = "response"))
ggplot(data = grouped_dat, aes(x = age_5_mid, y = obs_props)) +
geom_point(size = 3) +
geom_line(data = newdf2, aes(x = age, y = pred_probs)) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.2)) +
scale_x_continuous(limits = c(15, 45), breaks = seq(15, 45, by = 5)) +
xlab("Maternal Age (yrs)") + ylab("Predicted Probability of Low Birthweight") +
theme_bw(base_size = 20)
