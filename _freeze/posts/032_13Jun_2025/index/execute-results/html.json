{
  "hash": "1a4f24e450f51512a7cd009c5b31d029",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Model Prediction/Visualisation <br> 6. Survival Analysis - Cox Model\"\ndate: 2025-06-13\ncategories: [code, concept, modelling, visualisation]\n# image: \"images/plot.png\"\ndescription: \"How to Survive Visualising the Cox Model.\"\n---\n\n\nIn the last post in this series on model prediction and visualisation in `R` we are going to talk about survival analysis and specifically the Cox model. Like the extensions to the standard linear model that we most recently discussed - the GLM and LMM - predicting with the Cox model is also relatively straightforward, but the intuition in how those predictions are calculated may be less so. I hope to make that easier for you today.\n\nWe're going to use the inbuilt `GBSG2` dataset form the `TH.data` package, so please install that package if you don't already have it. The dataframe contains observations from the German Breast Cancer Study Group 2 study of `686` women, examining the effects of hormone treatment on recurrence-free survival time. The [variables](https://cran.r-project.org/web/packages/TH.data/TH.data.pdf) we'll be using are:\n\n-   `time` - recurrence free survival time (in days).\n\n-   `cens` - censoring indicator (0- censored, 1- event).\n\n-   `horTh` - hormonal therapy, a factor at two levels (yes and no).\n\n-   `tsize` - tumor size (in mm).\n\nThe first few rows of the data look like:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\nlibrary(survminer)\nlibrary(tidyverse)\nlibrary(kableExtra)\n# Load data\ndata(GBSG2, package = \"TH.data\")\nGBSG2 |> \n  select(time, cens, horTh, tsize) |> \n  head(10) |> \n  kable(align = \"c\", digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n| time | cens | horTh | tsize |\n|:----:|:----:|:-----:|:-----:|\n| 1814 |  1   |  no   |  21   |\n| 2018 |  1   |  yes  |  12   |\n| 712  |  1   |  yes  |  35   |\n| 1807 |  1   |  yes  |  17   |\n| 772  |  1   |  no   |  35   |\n| 448  |  1   |  no   |  57   |\n| 2172 |  0   |  yes  |   8   |\n| 2161 |  0   |  no   |  16   |\n| 471  |  1   |  no   |  39   |\n| 2014 |  0   |  no   |  18   |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Kaplan-Meier fit\nfit <- survfit(Surv(time, cens) ~ horTh, data = GBSG2)\n# Plot KM fit\nggsurvplot(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncox_mod <- coxph(Surv(time, cens) ~ horTh + tsize, data = GBSG2)\n\nnewdat <- expand.grid(time = seq(0, 2500, by = 50), \n                       cens = 1, \n                       horTh = levels(GBSG2$horTh),\n                       tsize = c(min(GBSG2$tsize), max(GBSG2$tsize)))\npreds <- predict(cox_mod, newdata = newdat, type = \"survival\", se.fit = TRUE)\nnewdat$prob <- preds$fit\n# If wanting to calculate 95% C.I.'s...\nnewdat$lcl <- preds$fit - 1.96*preds$se.fit\nnewdat$ucl <- preds$fit + 1.96*preds$se.fit\nhead(newdat, 10)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| time| cens|horTh | tsize|      prob|       lcl|       ucl|\n|----:|----:|:-----|-----:|---------:|---------:|---------:|\n|    0|    1|no    |     3| 1.0000000| 1.0000000| 1.0000000|\n|   50|    1|no    |     3| 1.0000000| 1.0000000| 1.0000000|\n|  100|    1|no    |     3| 0.9978193| 0.9947628| 1.0008759|\n|  150|    1|no    |     3| 0.9956329| 0.9912570| 1.0000088|\n|  200|    1|no    |     3| 0.9823370| 0.9729644| 0.9917096|\n|  250|    1|no    |     3| 0.9722758| 0.9600478| 0.9845038|\n|  300|    1|no    |     3| 0.9598787| 0.9445008| 0.9752567|\n|  350|    1|no    |     3| 0.9438953| 0.9247684| 0.9630222|\n|  400|    1|no    |     3| 0.9230845| 0.8993968| 0.9467722|\n|  450|    1|no    |     3| 0.9078727| 0.8810201| 0.9347253|\n\n</div>\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(newdat, aes(x = time, y = prob, color = horTh)) +\n  geom_line() +\n  facet_wrap(~ tsize) +\n  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, by = 0.1)) +\n  theme_bw(base_size = 20)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=1152}\n:::\n:::\n\n\nmanually\n\nhttps://www.graphpad.com/guides/prism/latest/statistics/stat_cox_math_cumulative_hazard.htm\n\n\n::: {.cell}\n\n```{.r .cell-code}\nH0 <- basehaz(cox_mod, centered = F) # Cumulative baseline hazard\ncox_mod$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   horThyes       tsize \n-0.37358834  0.01525192 \n```\n\n\n:::\n\n```{.r .cell-code}\nH <- H0$hazard * exp((1 * cox_mod$coefficients[1]) + (120 * cox_mod$coefficients[2])) # Cumulative hazard for 2nd covariate pattern of newdat (horTh = yes and tsize = 20)\nS <- exp(- H) # Survival probability\ndata.frame(time = H0$time, Surv = S)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| time|      Surv|\n|----:|---------:|\n|    8| 1.0000000|\n|   15| 1.0000000|\n|   16| 1.0000000|\n|   17| 1.0000000|\n|   18| 1.0000000|\n|   29| 1.0000000|\n|   42| 1.0000000|\n|   46| 1.0000000|\n|   57| 1.0000000|\n|   63| 1.0000000|\n|   65| 1.0000000|\n|   67| 1.0000000|\n|   71| 1.0000000|\n|   72| 0.9955379|\n|   98| 0.9910904|\n|  113| 0.9866529|\n|  114| 0.9866529|\n|  120| 0.9822175|\n|  148| 0.9822175|\n|  160| 0.9777796|\n|  168| 0.9777796|\n|  169| 0.9733272|\n|  171| 0.9688907|\n|  173| 0.9644675|\n|  175| 0.9600582|\n|  177| 0.9512790|\n|  180| 0.9469055|\n|  181| 0.9425473|\n|  184| 0.9382017|\n|  186| 0.9382017|\n|  191| 0.9338669|\n|  195| 0.9295468|\n|  205| 0.9252311|\n|  213| 0.9252311|\n|  223| 0.9209234|\n|  227| 0.9166294|\n|  229| 0.9166294|\n|  233| 0.9123458|\n|  238| 0.9080756|\n|  241| 0.9038204|\n|  242| 0.8995766|\n|  247| 0.8953472|\n|  249| 0.8911318|\n|  251| 0.8869295|\n|  272| 0.8785634|\n|  273| 0.8785634|\n|  275| 0.8743909|\n|  276| 0.8743909|\n|  281| 0.8660669|\n|  285| 0.8577871|\n|  286| 0.8536654|\n|  288| 0.8495584|\n|  293| 0.8454627|\n|  296| 0.8454627|\n|  305| 0.8413757|\n|  307| 0.8372992|\n|  308| 0.8291864|\n|  310| 0.8291864|\n|  316| 0.8251430|\n|  319| 0.8251430|\n|  322| 0.8251430|\n|  329| 0.8211013|\n|  336| 0.8170730|\n|  338| 0.8050621|\n|  343| 0.8010821|\n|  344| 0.7971146|\n|  348| 0.7931606|\n|  350| 0.7892199|\n|  353| 0.7852888|\n|  357| 0.7813701|\n|  358| 0.7774656|\n|  359| 0.7696879|\n|  360| 0.7658176|\n|  368| 0.7658176|\n|  369| 0.7619556|\n|  370| 0.7542722|\n|  371| 0.7504475|\n|  372| 0.7466356|\n|  374| 0.7428368|\n|  375| 0.7390516|\n|  377| 0.7352768|\n|  379| 0.7315147|\n|  385| 0.7277589|\n|  392| 0.7240146|\n|  394| 0.7202848|\n|  403| 0.7165684|\n|  410| 0.7128651|\n|  415| 0.7091761|\n|  417| 0.7054966|\n|  420| 0.6981783|\n|  424| 0.6981783|\n|  426| 0.6908924|\n|  429| 0.6908924|\n|  432| 0.6908924|\n|  436| 0.6872602|\n|  438| 0.6836418|\n|  446| 0.6800371|\n|  448| 0.6764404|\n|  449| 0.6728521|\n|  455| 0.6692745|\n|  456| 0.6657084|\n|  460| 0.6621548|\n|  461| 0.6621548|\n|  463| 0.6621548|\n|  465| 0.6586038|\n|  471| 0.6550657|\n|  473| 0.6515386|\n|  475| 0.6480253|\n|  476| 0.6410399|\n|  481| 0.6375652|\n|  486| 0.6341035|\n|  488| 0.6341035|\n|  490| 0.6306495|\n|  491| 0.6203548|\n|  495| 0.6169442|\n|  498| 0.6135464|\n|  500| 0.6101618|\n|  502| 0.6067885|\n|  503| 0.6034294|\n|  504| 0.6000826|\n|  515| 0.5967489|\n|  518| 0.5934288|\n|  525| 0.5901213|\n|  526| 0.5901213|\n|  529| 0.5868206|\n|  530| 0.5835253|\n|  533| 0.5802417|\n|  535| 0.5769665|\n|  536| 0.5736999|\n|  537| 0.5704458|\n|  540| 0.5672025|\n|  541| 0.5672025|\n|  542| 0.5639628|\n|  544| 0.5575253|\n|  545| 0.5543261|\n|  546| 0.5543261|\n|  547| 0.5511300|\n|  548| 0.5416095|\n|  550| 0.5353270|\n|  552| 0.5290914|\n|  553| 0.5290914|\n|  554| 0.5228945|\n|  557| 0.5198135|\n|  559| 0.5167466|\n|  563| 0.5136938|\n|  564| 0.5106532|\n|  566| 0.5106532|\n|  567| 0.5106532|\n|  570| 0.5106532|\n|  571| 0.5076105|\n|  573| 0.5045759|\n|  575| 0.5015558|\n|  577| 0.4985474|\n|  578| 0.4955518|\n|  579| 0.4925677|\n|  586| 0.4895959|\n|  594| 0.4836881|\n|  595| 0.4807511|\n|  596| 0.4807511|\n|  598| 0.4778186|\n|  600| 0.4749003|\n|  612| 0.4719867|\n|  615| 0.4719867|\n|  622| 0.4690778|\n|  623| 0.4690778|\n|  624| 0.4632694|\n|  628| 0.4632694|\n|  629| 0.4603763|\n|  631| 0.4603763|\n|  632| 0.4574828|\n|  637| 0.4546032|\n|  646| 0.4517295|\n|  648| 0.4488687|\n|  650| 0.4460126|\n|  651| 0.4460126|\n|  652| 0.4460126|\n|  657| 0.4460126|\n|  662| 0.4431430|\n|  663| 0.4431430|\n|  670| 0.4402802|\n|  675| 0.4374291|\n|  679| 0.4345861|\n|  687| 0.4317515|\n|  692| 0.4317515|\n|  695| 0.4317515|\n|  698| 0.4289191|\n|  707| 0.4261006|\n|  712| 0.4232933|\n|  714| 0.4204994|\n|  717| 0.4204994|\n|  721| 0.4204994|\n|  722| 0.4177057|\n|  723| 0.4177057|\n|  727| 0.4149140|\n|  729| 0.4121348|\n|  730| 0.4093678|\n|  731| 0.4066151|\n|  732| 0.4038730|\n|  733| 0.4038730|\n|  734| 0.4038730|\n|  737| 0.4038730|\n|  740| 0.4038730|\n|  741| 0.4038730|\n|  742| 0.4010979|\n|  745| 0.3983345|\n|  747| 0.3955781|\n|  748| 0.3928299|\n|  751| 0.3928299|\n|  753| 0.3928299|\n|  754| 0.3900834|\n|  755| 0.3873485|\n|  758| 0.3873485|\n|  761| 0.3873485|\n|  762| 0.3846125|\n|  766| 0.3846125|\n|  768| 0.3846125|\n|  769| 0.3818716|\n|  770| 0.3818716|\n|  772| 0.3791391|\n|  776| 0.3764107|\n|  779| 0.3764107|\n|  784| 0.3736806|\n|  790| 0.3709655|\n|  792| 0.3709655|\n|  795| 0.3682596|\n|  797| 0.3628860|\n|  798| 0.3628860|\n|  799| 0.3602147|\n|  801| 0.3575580|\n|  805| 0.3549148|\n|  806| 0.3549148|\n|  819| 0.3522793|\n|  825| 0.3522793|\n|  827| 0.3496520|\n|  828| 0.3496520|\n|  836| 0.3470353|\n|  838| 0.3444332|\n|  841| 0.3444332|\n|  842| 0.3418376|\n|  853| 0.3418376|\n|  854| 0.3418376|\n|  855| 0.3366437|\n|  857| 0.3340620|\n|  858| 0.3340620|\n|  859| 0.3289157|\n|  861| 0.3263522|\n|  865| 0.3238021|\n|  866| 0.3212595|\n|  867| 0.3187283|\n|  870| 0.3187283|\n|  876| 0.3161988|\n|  877| 0.3161988|\n|  883| 0.3136751|\n|  888| 0.3136751|\n|  889| 0.3111603|\n|  890| 0.3086598|\n|  891| 0.3061754|\n|  892| 0.3061754|\n|  893| 0.3036967|\n|  916| 0.3036967|\n|  918| 0.3012259|\n|  933| 0.3012259|\n|  936| 0.3012259|\n|  940| 0.3012259|\n|  942| 0.3012259|\n|  945| 0.2987193|\n|  956| 0.2937338|\n|  959| 0.2912609|\n|  960| 0.2888023|\n|  964| 0.2863585|\n|  967| 0.2863585|\n|  969| 0.2863585|\n|  970| 0.2863585|\n|  972| 0.2863585|\n|  973| 0.2863585|\n|  974| 0.2863585|\n|  981| 0.2838746|\n|  982| 0.2814037|\n|  983| 0.2789419|\n|  986| 0.2789419|\n|  991| 0.2764865|\n|  995| 0.2764865|\n| 1002| 0.2740313|\n| 1013| 0.2740313|\n| 1036| 0.2715810|\n| 1043| 0.2691471|\n| 1059| 0.2667300|\n| 1062| 0.2667300|\n| 1077| 0.2667300|\n| 1078| 0.2667300|\n| 1080| 0.2643104|\n| 1088| 0.2643104|\n| 1089| 0.2643104|\n| 1090| 0.2618769|\n| 1091| 0.2618769|\n| 1093| 0.2594402|\n| 1094| 0.2570106|\n| 1095| 0.2570106|\n| 1100| 0.2570106|\n| 1105| 0.2521301|\n| 1108| 0.2497119|\n| 1109| 0.2497119|\n| 1113| 0.2497119|\n| 1114| 0.2497119|\n| 1117| 0.2497119|\n| 1119| 0.2497119|\n| 1120| 0.2472751|\n| 1125| 0.2472751|\n| 1140| 0.2448491|\n| 1146| 0.2424390|\n| 1150| 0.2400465|\n| 1152| 0.2400465|\n| 1157| 0.2376566|\n| 1162| 0.2352835|\n| 1163| 0.2352835|\n| 1164| 0.2329210|\n| 1167| 0.2329210|\n| 1169| 0.2329210|\n| 1170| 0.2305554|\n| 1171| 0.2305554|\n| 1174| 0.2281974|\n| 1177| 0.2281974|\n| 1182| 0.2281974|\n| 1183| 0.2258332|\n| 1185| 0.2258332|\n| 1192| 0.2234780|\n| 1193| 0.2211300|\n| 1195| 0.2211300|\n| 1205| 0.2211300|\n| 1207| 0.2187833|\n| 1208| 0.2187833|\n| 1212| 0.2187833|\n| 1218| 0.2164256|\n| 1219| 0.2140848|\n| 1222| 0.2140848|\n| 1225| 0.2117374|\n| 1230| 0.2117374|\n| 1231| 0.2117374|\n| 1232| 0.2117374|\n| 1233| 0.2117374|\n| 1240| 0.2117374|\n| 1243| 0.2117374|\n| 1246| 0.2093499|\n| 1250| 0.2093499|\n| 1253| 0.2069662|\n| 1264| 0.2069662|\n| 1277| 0.2069662|\n| 1279| 0.2045793|\n| 1280| 0.1998614|\n| 1283| 0.1998614|\n| 1296| 0.1975271|\n| 1306| 0.1951998|\n| 1317| 0.1951998|\n| 1323| 0.1951998|\n| 1329| 0.1928744|\n| 1331| 0.1928744|\n| 1337| 0.1905523|\n| 1340| 0.1905523|\n| 1341| 0.1905523|\n| 1342| 0.1905523|\n| 1343| 0.1882193|\n| 1349| 0.1882193|\n| 1350| 0.1882193|\n| 1351| 0.1882193|\n| 1352| 0.1858649|\n| 1355| 0.1858649|\n| 1356| 0.1858649|\n| 1357| 0.1858649|\n| 1358| 0.1858649|\n| 1363| 0.1834842|\n| 1364| 0.1834842|\n| 1366| 0.1811143|\n| 1371| 0.1787647|\n| 1387| 0.1764345|\n| 1388| 0.1741250|\n| 1401| 0.1741250|\n| 1420| 0.1718272|\n| 1427| 0.1718272|\n| 1432| 0.1718272|\n| 1434| 0.1718272|\n| 1435| 0.1718272|\n| 1441| 0.1718272|\n| 1443| 0.1718272|\n| 1449| 0.1694594|\n| 1459| 0.1670985|\n| 1460| 0.1647511|\n| 1463| 0.1624263|\n| 1469| 0.1624263|\n| 1472| 0.1624263|\n| 1475| 0.1624263|\n| 1481| 0.1600703|\n| 1483| 0.1600703|\n| 1486| 0.1600703|\n| 1490| 0.1600703|\n| 1493| 0.1577025|\n| 1499| 0.1577025|\n| 1502| 0.1553107|\n| 1505| 0.1553107|\n| 1514| 0.1553107|\n| 1521| 0.1528924|\n| 1525| 0.1505030|\n| 1527| 0.1505030|\n| 1528| 0.1481255|\n| 1557| 0.1481255|\n| 1560| 0.1481255|\n| 1570| 0.1481255|\n| 1578| 0.1481255|\n| 1582| 0.1481255|\n| 1587| 0.1457139|\n| 1589| 0.1433272|\n| 1598| 0.1433272|\n| 1600| 0.1433272|\n| 1601| 0.1409378|\n| 1603| 0.1409378|\n| 1604| 0.1409378|\n| 1617| 0.1409378|\n| 1624| 0.1409378|\n| 1625| 0.1409378|\n| 1627| 0.1409378|\n| 1629| 0.1409378|\n| 1632| 0.1409378|\n| 1637| 0.1409378|\n| 1641| 0.1384293|\n| 1642| 0.1384293|\n| 1645| 0.1384293|\n| 1653| 0.1384293|\n| 1655| 0.1384293|\n| 1666| 0.1384293|\n| 1675| 0.1358614|\n| 1679| 0.1333036|\n| 1680| 0.1333036|\n| 1684| 0.1307653|\n| 1685| 0.1307653|\n| 1692| 0.1307653|\n| 1693| 0.1307653|\n| 1701| 0.1282114|\n| 1702| 0.1282114|\n| 1703| 0.1282114|\n| 1707| 0.1282114|\n| 1714| 0.1282114|\n| 1717| 0.1282114|\n| 1720| 0.1282114|\n| 1721| 0.1282114|\n| 1722| 0.1282114|\n| 1729| 0.1282114|\n| 1730| 0.1253555|\n| 1735| 0.1253555|\n| 1743| 0.1253555|\n| 1751| 0.1253555|\n| 1753| 0.1224330|\n| 1756| 0.1224330|\n| 1760| 0.1224330|\n| 1763| 0.1195093|\n| 1765| 0.1195093|\n| 1767| 0.1195093|\n| 1771| 0.1195093|\n| 1781| 0.1195093|\n| 1786| 0.1195093|\n| 1789| 0.1195093|\n| 1791| 0.1195093|\n| 1806| 0.1164867|\n| 1807| 0.1135168|\n| 1814| 0.1077219|\n| 1818| 0.1077219|\n| 1820| 0.1077219|\n| 1821| 0.1077219|\n| 1826| 0.1077219|\n| 1833| 0.1077219|\n| 1834| 0.1077219|\n| 1838| 0.1077219|\n| 1840| 0.1077219|\n| 1841| 0.1077219|\n| 1842| 0.1077219|\n| 1846| 0.1077219|\n| 1847| 0.1077219|\n| 1852| 0.1077219|\n| 1853| 0.1077219|\n| 1854| 0.1077219|\n| 1855| 0.1077219|\n| 1856| 0.1077219|\n| 1858| 0.1077219|\n| 1861| 0.1077219|\n| 1862| 0.1077219|\n| 1863| 0.1077219|\n| 1866| 0.1077219|\n| 1868| 0.1077219|\n| 1869| 0.1077219|\n| 1878| 0.1077219|\n| 1884| 0.1077219|\n| 1897| 0.1077219|\n| 1904| 0.1077219|\n| 1905| 0.1077219|\n| 1918| 0.1039537|\n| 1922| 0.1039537|\n| 1926| 0.1039537|\n| 1933| 0.1039537|\n| 1938| 0.1039537|\n| 1956| 0.1039537|\n| 1959| 0.1039537|\n| 1965| 0.1039537|\n| 1975| 0.0998596|\n| 1976| 0.0998596|\n| 1977| 0.0958183|\n| 1979| 0.0958183|\n| 1981| 0.0958183|\n| 1984| 0.0958183|\n| 1989| 0.0916804|\n| 1990| 0.0876847|\n| 2007| 0.0876847|\n| 2009| 0.0876847|\n| 2010| 0.0876847|\n| 2011| 0.0876847|\n| 2014| 0.0876847|\n| 2015| 0.0834654|\n| 2017| 0.0834654|\n| 2018| 0.0793659|\n| 2024| 0.0793659|\n| 2027| 0.0793659|\n| 2030| 0.0753380|\n| 2034| 0.0714203|\n| 2039| 0.0676393|\n| 2048| 0.0676393|\n| 2049| 0.0676393|\n| 2051| 0.0676393|\n| 2052| 0.0676393|\n| 2056| 0.0676393|\n| 2057| 0.0676393|\n| 2059| 0.0676393|\n| 2065| 0.0676393|\n| 2093| 0.0633777|\n| 2126| 0.0633777|\n| 2128| 0.0633777|\n| 2132| 0.0633777|\n| 2138| 0.0633777|\n| 2144| 0.0633777|\n| 2148| 0.0633777|\n| 2153| 0.0633777|\n| 2156| 0.0633777|\n| 2161| 0.0633777|\n| 2170| 0.0633777|\n| 2172| 0.0633777|\n| 2175| 0.0633777|\n| 2177| 0.0633777|\n| 2192| 0.0633777|\n| 2195| 0.0633777|\n| 2205| 0.0633777|\n| 2217| 0.0633777|\n| 2227| 0.0633777|\n| 2233| 0.0633777|\n| 2234| 0.0633777|\n| 2237| 0.0633777|\n| 2239| 0.0633777|\n| 2271| 0.0633777|\n| 2286| 0.0555958|\n| 2296| 0.0555958|\n| 2297| 0.0555958|\n| 2320| 0.0555958|\n| 2353| 0.0555958|\n| 2370| 0.0555958|\n| 2372| 0.0458892|\n| 2380| 0.0458892|\n| 2388| 0.0458892|\n| 2401| 0.0458892|\n| 2438| 0.0458892|\n| 2449| 0.0458892|\n| 2456| 0.0327922|\n| 2467| 0.0327922|\n| 2471| 0.0327922|\n| 2539| 0.0327922|\n| 2551| 0.0327922|\n| 2556| 0.0327922|\n| 2563| 0.0327922|\n| 2612| 0.0327922|\n| 2659| 0.0327922|\n\n</div>\n:::\n\n```{.r .cell-code}\nplot(H0$time, S) # plot survival for the 2nd covariate pattern\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=1152}\n:::\n\n```{.r .cell-code}\n# Normally one doesn't worry about using basehaz - survfit does everything it does and more. Just can use to work from first principles if you want.\n# Compare survival probabilities calcualated manually from basehaz with those estimated from survfit\n1-H\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  1.000000000  1.000000000  1.000000000  1.000000000  1.000000000\n  [6]  1.000000000  1.000000000  1.000000000  1.000000000  1.000000000\n [11]  1.000000000  1.000000000  1.000000000  0.995527870  0.991050470\n [16]  0.986563032  0.986563032  0.982057492  0.982057492  0.977528991\n [21]  0.977528991  0.972964976  0.968396494  0.963820880  0.959238637\n [26]  0.950052101  0.945443973  0.940830854  0.936209642  0.936209642\n [31]  0.931578676  0.926941883  0.922288304  0.922288304  0.917621581\n [36]  0.912947963  0.912947963  0.908263823  0.903572411  0.898875414\n [41]  0.894168937  0.889456253  0.884737054  0.880010245  0.870532780\n [46]  0.870532780  0.865772305  0.865772305  0.856206849  0.846600709\n [51]  0.841784005  0.836961414  0.832128827  0.832128827  0.827282967\n [56]  0.822426214  0.812689661  0.812689661  0.807801467  0.807801467\n [61]  0.807801467  0.802891259  0.797973180  0.783164085  0.778208115\n [66]  0.773243221  0.768270403  0.763289754  0.758296297  0.753293642\n [71]  0.748284132  0.738229863  0.733188695  0.733188695  0.728133004\n [76]  0.717997979  0.712914415  0.707822019  0.702721026  0.697612458\n [81]  0.692491781  0.687362073  0.682214469  0.677056314  0.671891406\n [86]  0.666718368  0.661536856  0.656348531  0.651146723  0.640719209\n [91]  0.640719209  0.630228834  0.630228834  0.630228834  0.624957702\n [96]  0.619678783  0.614392055  0.609089015  0.603770297  0.598439041\n[101]  0.593096466  0.587744135  0.587744135  0.587744135  0.582366920\n[106]  0.576980264  0.571581325  0.566174401  0.555336346  0.549901272\n[111]  0.544456844  0.544456844  0.538994995  0.522536369  0.517023323\n[116]  0.511500652  0.505968963  0.500424992  0.494873795  0.489312064\n[121]  0.483741188  0.478161939  0.472572832  0.472572832  0.466963867\n[126]  0.461332495  0.455689422  0.450028995  0.444351240  0.438662959\n[131]  0.432961186  0.432961186  0.427232970  0.415752571  0.409997832\n[136]  0.409997832  0.404215395  0.386789935  0.375122518  0.363405931\n[141]  0.363405931  0.351624465  0.345714749  0.339797307  0.333872119\n[146]  0.327935467  0.327935467  0.327935467  0.327935467  0.321959153\n[151]  0.315962921  0.309959541  0.303943458  0.297916671  0.291876684\n[156]  0.285825142  0.273684920  0.267594376  0.267594376  0.261475965\n[161]  0.255349520  0.249195499  0.249195499  0.243013380  0.243013380\n[166]  0.230553366  0.230553366  0.224288992  0.224288992  0.217983941\n[171]  0.211669682  0.205328289  0.198975094  0.192592008  0.192592008\n[176]  0.192592008  0.192592008  0.186137229  0.186137229  0.179656084\n[181]  0.173159435  0.166638716  0.160094992  0.160094992  0.160094992\n[186]  0.153513108  0.146920227  0.140310027  0.133687855  0.133687855\n[191]  0.133687855  0.127021828  0.127021828  0.120315933  0.113595125\n[196]  0.106858750  0.100111702  0.093345074  0.093345074  0.093345074\n[201]  0.093345074  0.093345074  0.093345074  0.086450367  0.079536717\n[206]  0.072592921  0.065621389  0.065621389  0.065621389  0.058605309\n[211]  0.051569613  0.051569613  0.051569613  0.044481166  0.044481166\n[216]  0.044481166  0.037329148  0.037329148  0.030147908  0.022925446\n[221]  0.022925446  0.015646108  0.008353919  0.008353919  0.001032903\n[226] -0.013666531 -0.013666531 -0.021055027 -0.028457814 -0.035877443\n[231] -0.035877443 -0.043331059 -0.043331059 -0.050816812 -0.050816812\n[236] -0.058328867 -0.065855251 -0.065855251 -0.073419605 -0.073419605\n[241] -0.073419605 -0.088730136 -0.096428587 -0.096428587 -0.111953680\n[246] -0.119778194 -0.127622712 -0.135506065 -0.143416162 -0.143416162\n[251] -0.151384110 -0.151384110 -0.159397618 -0.159397618 -0.167447050\n[256] -0.175515507 -0.183597109 -0.183597109 -0.191725905 -0.191725905\n[261] -0.199894820 -0.199894820 -0.199894820 -0.199894820 -0.199894820\n[266] -0.208251079 -0.225081216 -0.233536017 -0.242012794 -0.250510672\n[271] -0.250510672 -0.250510672 -0.250510672 -0.250510672 -0.250510672\n[276] -0.250510672 -0.259222684 -0.267964962 -0.276751938 -0.276751938\n[281] -0.285593249 -0.285593249 -0.294512936 -0.294512936 -0.303494738\n[286] -0.312497031 -0.321518394 -0.321518394 -0.321518394 -0.321518394\n[291] -0.330630986 -0.330630986 -0.330630986 -0.339880818 -0.339880818\n[296] -0.349228936 -0.358638109 -0.358638109 -0.358638109 -0.377810118\n[301] -0.387447409 -0.387447409 -0.387447409 -0.387447409 -0.387447409\n[306] -0.387447409 -0.397253742 -0.397253742 -0.407112999 -0.417005282\n[311] -0.426922427 -0.426922427 -0.436928392 -0.446964223 -0.446964223\n[316] -0.457055781 -0.457055781 -0.457055781 -0.467263928 -0.467263928\n[321] -0.477544235 -0.477544235 -0.477544235 -0.487958758 -0.487958758\n[326] -0.498442137 -0.509004524 -0.509004524 -0.509004524 -0.519673375\n[331] -0.519673375 -0.519673375 -0.530508363 -0.541382943 -0.541382943\n[336] -0.552408374 -0.552408374 -0.552408374 -0.552408374 -0.552408374\n[341] -0.552408374 -0.552408374 -0.563748374 -0.563748374 -0.575199997\n[346] -0.575199997 -0.575199997 -0.586799583 -0.610131316 -0.610131316\n[351] -0.621879265 -0.633731524 -0.633731524 -0.633731524 -0.645716120\n[356] -0.645716120 -0.657828707 -0.657828707 -0.657828707 -0.657828707\n[361] -0.670147382 -0.670147382 -0.670147382 -0.670147382 -0.682735363\n[366] -0.682735363 -0.682735363 -0.682735363 -0.682735363 -0.695626854\n[371] -0.695626854 -0.708626764 -0.721684588 -0.734805500 -0.747981906\n[376] -0.747981906 -0.761265766 -0.761265766 -0.761265766 -0.761265766\n[381] -0.761265766 -0.761265766 -0.761265766 -0.775142022 -0.789171959\n[386] -0.803319509 -0.817530617 -0.817530617 -0.817530617 -0.817530617\n[391] -0.832142089 -0.832142089 -0.832142089 -0.832142089 -0.847045133\n[396] -0.847045133 -0.862327912 -0.862327912 -0.862327912 -0.878021003\n[401] -0.893772139 -0.893772139 -0.909695131 -0.909695131 -0.909695131\n[406] -0.909695131 -0.909695131 -0.909695131 -0.926110266 -0.942625222\n[411] -0.942625222 -0.942625222 -0.959436796 -0.959436796 -0.959436796\n[416] -0.959436796 -0.959436796 -0.959436796 -0.959436796 -0.959436796\n[421] -0.959436796 -0.959436796 -0.977395593 -0.977395593 -0.977395593\n[426] -0.977395593 -0.977395593 -0.977395593 -0.996119908 -1.015126247\n[431] -1.015126247 -1.034351352 -1.034351352 -1.034351352 -1.034351352\n[436] -1.054074924 -1.054074924 -1.054074924 -1.054074924 -1.054074924\n[441] -1.054074924 -1.054074924 -1.054074924 -1.054074924 -1.054074924\n[446] -1.076601459 -1.076601459 -1.076601459 -1.076601459 -1.100190963\n[451] -1.100190963 -1.100190963 -1.124361123 -1.124361123 -1.124361123\n[456] -1.124361123 -1.124361123 -1.124361123 -1.124361123 -1.124361123\n[461] -1.149978014 -1.175804051 -1.228202803 -1.228202803 -1.228202803\n[466] -1.228202803 -1.228202803 -1.228202803 -1.228202803 -1.228202803\n[471] -1.228202803 -1.228202803 -1.228202803 -1.228202803 -1.228202803\n[476] -1.228202803 -1.228202803 -1.228202803 -1.228202803 -1.228202803\n[481] -1.228202803 -1.228202803 -1.228202803 -1.228202803 -1.228202803\n[486] -1.228202803 -1.228202803 -1.228202803 -1.228202803 -1.228202803\n[491] -1.228202803 -1.228202803 -1.263809743 -1.263809743 -1.263809743\n[496] -1.263809743 -1.263809743 -1.263809743 -1.263809743 -1.263809743\n[501] -1.303989612 -1.303989612 -1.345302074 -1.345302074 -1.345302074\n[506] -1.345302074 -1.389447171 -1.434007414 -1.434007414 -1.434007414\n[511] -1.434007414 -1.434007414 -1.434007414 -1.483322544 -1.483322544\n[516] -1.533686497 -1.533686497 -1.533686497 -1.585771214 -1.639173304\n[521] -1.693566423 -1.693566423 -1.693566423 -1.693566423 -1.693566423\n[526] -1.693566423 -1.693566423 -1.693566423 -1.693566423 -1.758642660\n[531] -1.758642660 -1.758642660 -1.758642660 -1.758642660 -1.758642660\n[536] -1.758642660 -1.758642660 -1.758642660 -1.758642660 -1.758642660\n[541] -1.758642660 -1.758642660 -1.758642660 -1.758642660 -1.758642660\n[546] -1.758642660 -1.758642660 -1.758642660 -1.758642660 -1.758642660\n[551] -1.758642660 -1.758642660 -1.758642660 -1.889646870 -1.889646870\n[556] -1.889646870 -1.889646870 -1.889646870 -1.889646870 -2.081526202\n[561] -2.081526202 -2.081526202 -2.081526202 -2.081526202 -2.081526202\n[566] -2.417563911 -2.417563911 -2.417563911 -2.417563911 -2.417563911\n[571] -2.417563911 -2.417563911 -2.417563911 -2.417563911\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}