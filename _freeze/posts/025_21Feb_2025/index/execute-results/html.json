{
  "hash": "98de468df9b130325ec2104dedeeec26",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Missing Data and Multiple Imputation <br> for Dummies (Part 2)\"\ndate: 2025-02-21\ncategories: [code, concept, analysis]\n#image: \"images/mi_flow.png\"\ndescription: \"The core concepts and a simple example to get you up and running with MI in your next analysis.\"\nformat: \n   html:\n     df-print: tibble\n---\n\n\nWelcome to Part 2 of our tutorial on missing data and multiple imputation. If you recall, we ended the last post with a brief introduction to MI and so today I am going to extend that discussion further with some specific, but important detail in how MI actually works via its implementation in `R`. Having a better understanding of the algorithmic process involved is invaluable in contextualising what is actually happening to your data when you incorporate MI into your analysis. As an expository aid, we will also apply MI to a small dataset which I hope will further build your practical intuition of this fairly complex statistical topic.\n\n# MI in R\n\nIn general, there are two primary approaches to MI and these are implemented by different packages in `R`.\n\n-   Joint Multivariate Normal Distribution Multiple Imputation.\n\n    Joint modelling assumes that the observed data follows a multivariate normal distribution and consequently draws missing values from the same distribution. The biggest problem with this approach is that **a distribution is assumed for the entire dataset**, and this may not always be tenable, leading to incorrect imputations.\n\n-   Conditional Multiple Imputation\n\n    In contrast, the conditional approach is iterative, modelling **the conditional distribution of one variable, given the other variables**. In this way a different distribution may be assumed for each variable, rather than fixing the entire dataset to one distribution. The conditional MI approach tends to be more commonly used due to this enhanced flexibility and the procedure is implemented in the `mice` (multivariate imputation by chained equations) package in `R`. This is the approach we will focus on for the remainder of this tutorial.\n\n# The mice Package\n\n## Example Data\n\nBefore we go any further, let me introduce a small dataset included in the `mice` package that we will use to illustrate conditional MI in action. The `nhanes2` dataset contains sample data from the US National Health and Nutrition Examination Study. It consists of `25` observations of `4` variables:\n\n-   **age** - Age group (1=20-39, 2=40-59, 3=60+)\n\n-   **bmi** - Body mass index (kg/m\\^2)\n\n-   **hyp** - Hypertensive (1=no,2=yes)\n\n-   **chl** - Total serum cholesterol (mg/dL)\n\n**age** and **hyp** are formatted as factors and **bmi** and **chl** as numeric. The data look like:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(mice)\nlibrary(gtsummary)\ndata(nhanes2)\nnhanes2 |> tibble() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 4\n   age     bmi hyp     chl\n   <fct> <dbl> <fct> <dbl>\n 1 20-39  NA   <NA>     NA\n 2 40-59  22.7 no      187\n 3 20-39  NA   no      187\n 4 60-99  NA   <NA>     NA\n 5 20-39  20.4 no      113\n 6 60-99  NA   <NA>    184\n 7 20-39  22.5 no      118\n 8 20-39  30.1 no      187\n 9 40-59  22   no      238\n10 40-59  NA   <NA>     NA\n11 20-39  NA   <NA>     NA\n12 40-59  NA   <NA>     NA\n13 60-99  21.7 no      206\n14 40-59  28.7 yes     204\n15 20-39  29.6 no       NA\n16 20-39  NA   <NA>     NA\n17 60-99  27.2 yes     284\n18 40-59  26.3 yes     199\n19 20-39  35.3 no      218\n20 60-99  25.5 yes      NA\n21 20-39  NA   <NA>     NA\n22 20-39  33.2 no      229\n23 20-39  27.5 no      131\n24 60-99  24.9 no       NA\n25 40-59  27.4 no      186\n```\n\n\n:::\n:::\n\n\nNote there is some missingness on all variables except **age**.\n\n## Overview\n\nIn the last post I suggested that MI can be thought of in broad terms as a three-step procedure: imputation, analysis, and pooling. Using the `mice` package, each of these steps can be equated with a function (blue) and resulting object (red) in your `R` workspace - in short:\n\n1.  `mice()` imputes the data, producing a `mids` object\n2.  `with()` analyses the data, producing a `mira` object\n3.  `pool()` combines the data, producing a `mipo` object\n\n![Main Steps in MI](images/mi_flow.png){fig-align=\"center\"}\n\nSo, imagine that we have our `nhanes2` dataset and we want to explore the relationship between **bmi** (as the outcome) and **age**, **hyp** and **chl** (as predictors). If we just go ahead and run a linear regression with the data as is, we get:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(bmi ~ age + hyp + chl, data = nhanes2) |> \n  tbl_regression() |> \n  add_glance_source_note()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"smhpfzgazl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#smhpfzgazl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#smhpfzgazl thead, #smhpfzgazl tbody, #smhpfzgazl tfoot, #smhpfzgazl tr, #smhpfzgazl td, #smhpfzgazl th {\n  border-style: none;\n}\n\n#smhpfzgazl p {\n  margin: 0;\n  padding: 0;\n}\n\n#smhpfzgazl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#smhpfzgazl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#smhpfzgazl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#smhpfzgazl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#smhpfzgazl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#smhpfzgazl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#smhpfzgazl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#smhpfzgazl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#smhpfzgazl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#smhpfzgazl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#smhpfzgazl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#smhpfzgazl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#smhpfzgazl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#smhpfzgazl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#smhpfzgazl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#smhpfzgazl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#smhpfzgazl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#smhpfzgazl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#smhpfzgazl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#smhpfzgazl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#smhpfzgazl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#smhpfzgazl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#smhpfzgazl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#smhpfzgazl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#smhpfzgazl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#smhpfzgazl .gt_left {\n  text-align: left;\n}\n\n#smhpfzgazl .gt_center {\n  text-align: center;\n}\n\n#smhpfzgazl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#smhpfzgazl .gt_font_normal {\n  font-weight: normal;\n}\n\n#smhpfzgazl .gt_font_bold {\n  font-weight: bold;\n}\n\n#smhpfzgazl .gt_font_italic {\n  font-style: italic;\n}\n\n#smhpfzgazl .gt_super {\n  font-size: 65%;\n}\n\n#smhpfzgazl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#smhpfzgazl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#smhpfzgazl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#smhpfzgazl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#smhpfzgazl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#smhpfzgazl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#smhpfzgazl .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    20-39</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    40-59</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-6.6</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-12, -1.3</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.021</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    60-99</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-11</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-19, -3.4</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.010</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">hyp</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    no</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    yes</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.4</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-3.5, 8.2</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.4</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">chl</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.08</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">0.02, 0.14</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.012</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">R² = 0.670; Adjusted R² = 0.505; Sigma = 3.23; Statistic = 4.06; p-value = 0.044; df = 4; Log-likelihood = -30.6; AIC = 73.1; BIC = 76.5; Deviance = 83.7; Residual df = 8; No. Obs. = 13</td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nEverything seems to look ok - regression coefficients seem plausible and standard errors haven't blown up. But if you look at the table footer you will see that `R`'s default setting of listwise deletion, means that only `13` observations have been able to be used. The model has discarded `48%` of the data. \"Unacceptable!\" you say. Not only have we lost a decent amount of power (and maybe that wouldn't concern you so much with a larger dataset), but we are also potentially at risk of bias if our missing data mechanism isn't MCAR (which is what complete case analysis assumes).\n\nGiven I want to show you how to use MI, I am going to do that regardless of whether these data are MCAR or not. So, I will leave as an exercise for you to test the MCAR assumption based on what I have shown you in the previous post, if you are interested (I actually haven't looked at this so I don't know whether MCAR may be considered reasonable in this case).\n\nSo let's run through the steps that `mice` uses if we were to impute these data.\n\nAs the first step, the `mice()` function creates several complete datasets (in the above we have set this to n = `3`). It considers the missingness in each variable to adhere to a particular distribution, drawing plausible values from this distribution as \"placeholders\" for the missing values. These \"complete\" datasets are then stored in an `R` object class called `mids` (which is an abbreviation of \"multiply imputed dataset\"). Each dataset is a copy of the original dataframe, **except** that the missing values are now replaced by those generated by `mice()`.\n\n::: callout-note\nI call these values placeholders as they are not fixed or actually observed, but merely serve to allow estimation of the parameter and its variance.\n:::\n\nIn the second step, we now analyse each of our three complete datasets. Using the `with()` function, we run the same linear regression model as above on each dataframe of `25` observations, obtaining three different regression coefficients for each parameter. These coefficients only differ due to the differences in the imputed values across each dataset. The analysis results are then stored in another `R` object class called `mira` (\"multiply imputed repeated analysis\").\n\nIn the third and final step, we pool the three coefficients from separate models into one overall regression coefficient for each parameter, and estimate its variance using the `pool()` function. The final coefficient is the simple average of the three separate coefficients. As described in the last post, the variance estimate combines both \"within\" (dataset) and \"between\" (dataset) variance components. The pooled results are stored in a `mipo` - \"multiple imputation pooled object\" - object class in your `R` environment. This becomes the object that you are interested in reporting the results from.\n\nThere is one other function in the `mice` package that is worth a mention - `complete()`. While this function isn't essential in the MI pipeline it is nonetheless a very helpful tool in examining the imputed datasets, and I will show you its usage, along with the other primary functions, shortly.\n\n## Iterations Within Imputations\n\nThere is one last bit of theory we will cover before we get to the practical example. In my understanding of MI, I found it super-helpful to have a cursory working knowledge of the chained equation equation approach. As I think this will also help you, we'll take a few minutes to flesh out some of the detail in what the procedure is actually doing in the background when you call `mice()` on your data.\n\nRecall that in essence the mice procedure runs a series of regression models whereby each variable with missing data is regressed conditional on the other variables present. In this way, variables that differ in their distribution can be modelled as such - for example, logistic regression for binary variables or linear regression for continuous. More explicitly, **the chained equation process can be broken down into one \"cycle\" or iteration, consisting of five steps**:\n\n**Iteration start** -\n\n-   Step 1: Every missing value in the dataset is replaced with a simple (single) imputation, such as the mean or median.\n\n-   Step 2: For one variable - let's call this \"mi_var\" - the simple imputations are set back to missing.\n\n-   Step 3: The observed values from \"mi_var\" in Step 2 are regressed (as the outcome) on the other variables (as predictors) in the imputation model, which may or may not consist of all remaining variables in the dataset. The distribution of \"mi_var\" is selected as appropriate for that variable.\n\n-   Step 4: The missing values for \"mi_var\" are then replaced with predictions (imputations) from the regression model.\n\n-   Step 5: Repeat Steps 2-4 for each variable that has missing data. Note that at the end of Step 4 \"mi_var\" may serve as a predictor for any other variable with missing data, whereby both the observed and imputed values will be used to predict that variable's missing values.\n\n**- Iteration end**\n\nAt the end of one iteration, all variables with missing data will have been replaced with predictions (imputations) from regression models that represent the associations observed in the data. Usually multiple iterations (ten is considered standard) are specified with the imputations being updated at the end of each cycle. Enough iterations should be specified to establish with confidence that the imputation parameter estimates (regression coefficients) should \"converge\" so they are no longer changing, within some tolerance, in a new cycle.\n\nSo, when we think of [Inception](https://en.wikipedia.org/wiki/Inception) as a movie about layers (dreams within dreams), it can be helpful to think of MI in a similar way, as also consisting of layers (iterations within imputations). Each call to `mice()` produces multiple imputed datasets where each imputed dataset is itself the result of multiple iterations. Hopefully your brain doesn't hurt like mine did when I watched Inception!\n\n# Practical Application of MI\n\nOk, enough talking. Let's actually work through an example - we'll use the `nhanes2` dataset I introduced above.\n\n## Inspect\n\nIt's always a good idea to first take a couple of minutes to inspect and/or visualise the missing values and any potential patterns in the data. Let's first check the number and proportion of missing values for each variable. We could code this ourselves, but there's actually a handy little function especially for this in the `questionr` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(questionr)\nfreq.na(nhanes2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    missing  %\nchl      10 40\nbmi       9 36\nhyp       8 32\nage       0  0\n```\n\n\n:::\n:::\n\n\nWe can extend this further to look for patterns of missing values and `mice` provides the `md.pattern()` function for this. An equivalent plot and tabulation are supplied by default but it is possible to suppress the plot if one wishes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmd.pattern(nhanes2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   age hyp bmi chl   \n13   1   1   1   1  0\n3    1   1   1   0  1\n1    1   1   0   1  1\n1    1   0   0   1  2\n7    1   0   0   0  3\n     0   8   9  10 27\n```\n\n\n:::\n:::\n\n\nValues are either 0 (missing) or 1 (observed). From top to bottom, we read this as:\n\n-   `13` people have no missing data.\n\n-   `3` people have missingness on **chl** only.\n\n-   `1` person has missingness on **bmi** only.\n\n-   `1` person has missingness on **hyp** and **bmi** only.\n\n-   `7` people have missingness on **hyp**, **bmi** and **chl**.\n\nThe numbers in the bottom row represent the frequencies of missingness on each variable and the resulting marginal total (far right). The numbers in the right-most column represent the number of variables with missingness in each pattern.\n\n## mice()\n\nNow, let's do the imputation. It's as simple as calling the `mice()` function on our dataset, but here I will specify `3` imputations rather than the default of `5`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nimp <-  mice(nhanes2, m = 3, print = FALSE)\nimp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClass: mids\nNumber of multiple imputations:  3 \nImputation methods:\n     age      bmi      hyp      chl \n      \"\"    \"pmm\" \"logreg\"    \"pmm\" \nPredictorMatrix:\n    age bmi hyp chl\nage   0   1   1   1\nbmi   1   0   1   1\nhyp   1   1   0   1\nchl   1   1   1   0\n```\n\n\n:::\n:::\n\n\nBy inspecting the resulting `mids` object, we can see that `mice()` used **pmm** (predictive mean matching) to impute all the variables except **hyp** which used logistic regression (**logreg**) instead, given this is a binary variable. Note that variables with no missing values will have no method (\"\") specified because no imputation is actually needed.\n\n::: callout-note\n[pmm](https://stefvanbuuren.name/fimd/sec-pmm.html) is the recommended and default method for the imputation of continuous data in `mice()`\n:::\n\nThe output also shows the `predictorMatrix` which determines what variables are used in the imputation of another. It is useful to familiarise yourself with this matrix as you may want to customise imputations at some point and amending the `predictorMatrix` provides such functionality. You can interpret the `predictorMatrix` as rows corresponding to incomplete target variables and columns as complete predictor variables. A value of `1` indicates that the column variable acts as a predictor to impute the target (row) variable, and a `0` means that it is not used. Thus, in our example, **hyp** is predicted from **age**, **bmi** and **chl**. Note that the diagonal is set to `0` since variables cannot predict themselves. The default setting of the `predictorMatrix` specifies that every variable predicts all others.\n\nAs a relatively quick diagnostic exercise, we can easily examine the correspondence between observed and imputed values (for the continuous variables at least) by using the `stripplot()` function. Note that `mice` provides other graphical tools for this that are also worth exploring.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstripplot(imp, col = c(\"red\", \"blue\"), pch = c(1, 20), cex = c(2, 2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=1152}\n:::\n:::\n\n\nThe plots show relatively good overlap of the imputed values (in blue) with the original non-missing data (red).\n\n## complete()\n\nAt this point you may actually want to look at the imputed values and datasets themselves. `mice` makes this easy with the `complete()` function and while this isn't integral to the workflow, it can be useful as another plausiblity check that the imputations are working as they should. There are multiple formats that we can view the imputed data in, and I will show you what I consider are the three main ways. In all cases, each observation will be labelled with its imputation number and I will also include the original data (imputation = 0) for comparison.\n\n### \"all\"\n\nUsing \"all\" produces a list, where each imputed dataframe becomes an element of that list.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimp_all <-  complete(imp, \"all\", include = T)\nimp_all\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`0`\n     age  bmi  hyp chl\n1  20-39   NA <NA>  NA\n2  40-59 22.7   no 187\n3  20-39   NA   no 187\n4  60-99   NA <NA>  NA\n5  20-39 20.4   no 113\n6  60-99   NA <NA> 184\n7  20-39 22.5   no 118\n8  20-39 30.1   no 187\n9  40-59 22.0   no 238\n10 40-59   NA <NA>  NA\n11 20-39   NA <NA>  NA\n12 40-59   NA <NA>  NA\n13 60-99 21.7   no 206\n14 40-59 28.7  yes 204\n15 20-39 29.6   no  NA\n16 20-39   NA <NA>  NA\n17 60-99 27.2  yes 284\n18 40-59 26.3  yes 199\n19 20-39 35.3   no 218\n20 60-99 25.5  yes  NA\n21 20-39   NA <NA>  NA\n22 20-39 33.2   no 229\n23 20-39 27.5   no 131\n24 60-99 24.9   no  NA\n25 40-59 27.4   no 186\n\n$`1`\n     age  bmi hyp chl\n1  20-39 30.1 yes 131\n2  40-59 22.7  no 187\n3  20-39 22.0  no 187\n4  60-99 22.7 yes 187\n5  20-39 20.4  no 113\n6  60-99 25.5 yes 184\n7  20-39 22.5  no 118\n8  20-39 30.1  no 187\n9  40-59 22.0  no 238\n10 40-59 27.4 yes 204\n11 20-39 33.2  no 199\n12 40-59 22.7 yes 187\n13 60-99 21.7  no 206\n14 40-59 28.7 yes 204\n15 20-39 29.6  no 199\n16 20-39 27.2  no 238\n17 60-99 27.2 yes 284\n18 40-59 26.3 yes 199\n19 20-39 35.3  no 218\n20 60-99 25.5 yes 131\n21 20-39 22.0  no 131\n22 20-39 33.2  no 229\n23 20-39 27.5  no 131\n24 60-99 24.9  no 131\n25 40-59 27.4  no 186\n\n$`2`\n     age  bmi hyp chl\n1  20-39 22.5  no 187\n2  40-59 22.7  no 187\n3  20-39 25.5  no 187\n4  60-99 27.4 yes 204\n5  20-39 20.4  no 113\n6  60-99 21.7  no 184\n7  20-39 22.5  no 118\n8  20-39 30.1  no 187\n9  40-59 22.0  no 238\n10 40-59 22.7 yes 187\n11 20-39 22.5  no 187\n12 40-59 25.5 yes 184\n13 60-99 21.7  no 206\n14 40-59 28.7 yes 204\n15 20-39 29.6  no 199\n16 20-39 22.7  no 131\n17 60-99 27.2 yes 284\n18 40-59 26.3 yes 199\n19 20-39 35.3  no 218\n20 60-99 25.5 yes 206\n21 20-39 26.3  no 187\n22 20-39 33.2  no 229\n23 20-39 27.5  no 131\n24 60-99 24.9  no 186\n25 40-59 27.4  no 186\n\n$`3`\n     age  bmi hyp chl\n1  20-39 27.2  no 187\n2  40-59 22.7  no 187\n3  20-39 26.3  no 187\n4  60-99 21.7  no 186\n5  20-39 20.4  no 113\n6  60-99 21.7  no 184\n7  20-39 22.5  no 118\n8  20-39 30.1  no 187\n9  40-59 22.0  no 238\n10 40-59 25.5  no 187\n11 20-39 28.7 yes 238\n12 40-59 27.5 yes 206\n13 60-99 21.7  no 206\n14 40-59 28.7 yes 204\n15 20-39 29.6  no 131\n16 20-39 30.1  no 238\n17 60-99 27.2 yes 284\n18 40-59 26.3 yes 199\n19 20-39 35.3  no 218\n20 60-99 25.5 yes 218\n21 20-39 20.4  no 238\n22 20-39 33.2  no 229\n23 20-39 27.5  no 131\n24 60-99 24.9  no 206\n25 40-59 27.4  no 186\n\nattr(,\"class\")\n[1] \"mild\" \"list\"\n```\n\n\n:::\n:::\n\n\n### \"long\"\n\nUsing \"long\" produces a dataframe of imputations stacked on top of each other. Imputation and ID numbers are provided as variables to identify which observations belong to which imputations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimp_long <-  complete(imp, \"long\", include = T)\nimp_long |> tibble() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 6\n     .imp   .id age     bmi hyp     chl\n    <int> <int> <fct> <dbl> <fct> <dbl>\n  1     0     1 20-39  NA   <NA>     NA\n  2     0     2 40-59  22.7 no      187\n  3     0     3 20-39  NA   no      187\n  4     0     4 60-99  NA   <NA>     NA\n  5     0     5 20-39  20.4 no      113\n  6     0     6 60-99  NA   <NA>    184\n  7     0     7 20-39  22.5 no      118\n  8     0     8 20-39  30.1 no      187\n  9     0     9 40-59  22   no      238\n 10     0    10 40-59  NA   <NA>     NA\n 11     0    11 20-39  NA   <NA>     NA\n 12     0    12 40-59  NA   <NA>     NA\n 13     0    13 60-99  21.7 no      206\n 14     0    14 40-59  28.7 yes     204\n 15     0    15 20-39  29.6 no       NA\n 16     0    16 20-39  NA   <NA>     NA\n 17     0    17 60-99  27.2 yes     284\n 18     0    18 40-59  26.3 yes     199\n 19     0    19 20-39  35.3 no      218\n 20     0    20 60-99  25.5 yes      NA\n 21     0    21 20-39  NA   <NA>     NA\n 22     0    22 20-39  33.2 no      229\n 23     0    23 20-39  27.5 no      131\n 24     0    24 60-99  24.9 no       NA\n 25     0    25 40-59  27.4 no      186\n 26     1     1 20-39  30.1 yes     131\n 27     1     2 40-59  22.7 no      187\n 28     1     3 20-39  22   no      187\n 29     1     4 60-99  22.7 yes     187\n 30     1     5 20-39  20.4 no      113\n 31     1     6 60-99  25.5 yes     184\n 32     1     7 20-39  22.5 no      118\n 33     1     8 20-39  30.1 no      187\n 34     1     9 40-59  22   no      238\n 35     1    10 40-59  27.4 yes     204\n 36     1    11 20-39  33.2 no      199\n 37     1    12 40-59  22.7 yes     187\n 38     1    13 60-99  21.7 no      206\n 39     1    14 40-59  28.7 yes     204\n 40     1    15 20-39  29.6 no      199\n 41     1    16 20-39  27.2 no      238\n 42     1    17 60-99  27.2 yes     284\n 43     1    18 40-59  26.3 yes     199\n 44     1    19 20-39  35.3 no      218\n 45     1    20 60-99  25.5 yes     131\n 46     1    21 20-39  22   no      131\n 47     1    22 20-39  33.2 no      229\n 48     1    23 20-39  27.5 no      131\n 49     1    24 60-99  24.9 no      131\n 50     1    25 40-59  27.4 no      186\n 51     2     1 20-39  22.5 no      187\n 52     2     2 40-59  22.7 no      187\n 53     2     3 20-39  25.5 no      187\n 54     2     4 60-99  27.4 yes     204\n 55     2     5 20-39  20.4 no      113\n 56     2     6 60-99  21.7 no      184\n 57     2     7 20-39  22.5 no      118\n 58     2     8 20-39  30.1 no      187\n 59     2     9 40-59  22   no      238\n 60     2    10 40-59  22.7 yes     187\n 61     2    11 20-39  22.5 no      187\n 62     2    12 40-59  25.5 yes     184\n 63     2    13 60-99  21.7 no      206\n 64     2    14 40-59  28.7 yes     204\n 65     2    15 20-39  29.6 no      199\n 66     2    16 20-39  22.7 no      131\n 67     2    17 60-99  27.2 yes     284\n 68     2    18 40-59  26.3 yes     199\n 69     2    19 20-39  35.3 no      218\n 70     2    20 60-99  25.5 yes     206\n 71     2    21 20-39  26.3 no      187\n 72     2    22 20-39  33.2 no      229\n 73     2    23 20-39  27.5 no      131\n 74     2    24 60-99  24.9 no      186\n 75     2    25 40-59  27.4 no      186\n 76     3     1 20-39  27.2 no      187\n 77     3     2 40-59  22.7 no      187\n 78     3     3 20-39  26.3 no      187\n 79     3     4 60-99  21.7 no      186\n 80     3     5 20-39  20.4 no      113\n 81     3     6 60-99  21.7 no      184\n 82     3     7 20-39  22.5 no      118\n 83     3     8 20-39  30.1 no      187\n 84     3     9 40-59  22   no      238\n 85     3    10 40-59  25.5 no      187\n 86     3    11 20-39  28.7 yes     238\n 87     3    12 40-59  27.5 yes     206\n 88     3    13 60-99  21.7 no      206\n 89     3    14 40-59  28.7 yes     204\n 90     3    15 20-39  29.6 no      131\n 91     3    16 20-39  30.1 no      238\n 92     3    17 60-99  27.2 yes     284\n 93     3    18 40-59  26.3 yes     199\n 94     3    19 20-39  35.3 no      218\n 95     3    20 60-99  25.5 yes     218\n 96     3    21 20-39  20.4 no      238\n 97     3    22 20-39  33.2 no      229\n 98     3    23 20-39  27.5 no      131\n 99     3    24 60-99  24.9 no      206\n100     3    25 40-59  27.4 no      186\n```\n\n\n:::\n:::\n\n\n### \"broad\"\n\nIn contrast, the \"broad\" or wide format produces a dataframe of imputations stacked side-by-side. Imputation numbers are included in the variable names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimp_wide <-  complete(imp, \"broad\", include = T)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `age` -> `age...1`\n• `bmi` -> `bmi...2`\n• `hyp` -> `hyp...3`\n• `chl` -> `chl...4`\n• `age` -> `age...5`\n• `bmi` -> `bmi...6`\n• `hyp` -> `hyp...7`\n• `chl` -> `chl...8`\n• `age` -> `age...9`\n• `bmi` -> `bmi...10`\n• `hyp` -> `hyp...11`\n• `chl` -> `chl...12`\n• `age` -> `age...13`\n• `bmi` -> `bmi...14`\n• `hyp` -> `hyp...15`\n• `chl` -> `chl...16`\n```\n\n\n:::\n\n```{.r .cell-code}\nimp_wide |> tibble() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 16\n   age.0 bmi.0 hyp.0 chl.0 age.1 bmi.1 hyp.1 chl.1 age.2 bmi.2 hyp.2 chl.2 age.3\n   <fct> <dbl> <fct> <dbl> <fct> <dbl> <fct> <dbl> <fct> <dbl> <fct> <dbl> <fct>\n 1 20-39  NA   <NA>     NA 20-39  30.1 yes     131 20-39  22.5 no      187 20-39\n 2 40-59  22.7 no      187 40-59  22.7 no      187 40-59  22.7 no      187 40-59\n 3 20-39  NA   no      187 20-39  22   no      187 20-39  25.5 no      187 20-39\n 4 60-99  NA   <NA>     NA 60-99  22.7 yes     187 60-99  27.4 yes     204 60-99\n 5 20-39  20.4 no      113 20-39  20.4 no      113 20-39  20.4 no      113 20-39\n 6 60-99  NA   <NA>    184 60-99  25.5 yes     184 60-99  21.7 no      184 60-99\n 7 20-39  22.5 no      118 20-39  22.5 no      118 20-39  22.5 no      118 20-39\n 8 20-39  30.1 no      187 20-39  30.1 no      187 20-39  30.1 no      187 20-39\n 9 40-59  22   no      238 40-59  22   no      238 40-59  22   no      238 40-59\n10 40-59  NA   <NA>     NA 40-59  27.4 yes     204 40-59  22.7 yes     187 40-59\n11 20-39  NA   <NA>     NA 20-39  33.2 no      199 20-39  22.5 no      187 20-39\n12 40-59  NA   <NA>     NA 40-59  22.7 yes     187 40-59  25.5 yes     184 40-59\n13 60-99  21.7 no      206 60-99  21.7 no      206 60-99  21.7 no      206 60-99\n14 40-59  28.7 yes     204 40-59  28.7 yes     204 40-59  28.7 yes     204 40-59\n15 20-39  29.6 no       NA 20-39  29.6 no      199 20-39  29.6 no      199 20-39\n16 20-39  NA   <NA>     NA 20-39  27.2 no      238 20-39  22.7 no      131 20-39\n17 60-99  27.2 yes     284 60-99  27.2 yes     284 60-99  27.2 yes     284 60-99\n18 40-59  26.3 yes     199 40-59  26.3 yes     199 40-59  26.3 yes     199 40-59\n19 20-39  35.3 no      218 20-39  35.3 no      218 20-39  35.3 no      218 20-39\n20 60-99  25.5 yes      NA 60-99  25.5 yes     131 60-99  25.5 yes     206 60-99\n21 20-39  NA   <NA>     NA 20-39  22   no      131 20-39  26.3 no      187 20-39\n22 20-39  33.2 no      229 20-39  33.2 no      229 20-39  33.2 no      229 20-39\n23 20-39  27.5 no      131 20-39  27.5 no      131 20-39  27.5 no      131 20-39\n24 60-99  24.9 no       NA 60-99  24.9 no      131 60-99  24.9 no      186 60-99\n25 40-59  27.4 no      186 40-59  27.4 no      186 40-59  27.4 no      186 40-59\n# ℹ 3 more variables: bmi.3 <dbl>, hyp.3 <fct>, chl.3 <dbl>\n```\n\n\n:::\n:::\n\n\n### View just one imputation\n\nAll good you say, but what if I want to view just one imputation. Well you can do that quite easily in the call to `complete()`. Here we will ask for just the second imputation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomplete(imp, 2) |> tibble() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 4\n   age     bmi hyp     chl\n   <fct> <dbl> <fct> <dbl>\n 1 20-39  22.5 no      187\n 2 40-59  22.7 no      187\n 3 20-39  25.5 no      187\n 4 60-99  27.4 yes     204\n 5 20-39  20.4 no      113\n 6 60-99  21.7 no      184\n 7 20-39  22.5 no      118\n 8 20-39  30.1 no      187\n 9 40-59  22   no      238\n10 40-59  22.7 yes     187\n11 20-39  22.5 no      187\n12 40-59  25.5 yes     184\n13 60-99  21.7 no      206\n14 40-59  28.7 yes     204\n15 20-39  29.6 no      199\n16 20-39  22.7 no      131\n17 60-99  27.2 yes     284\n18 40-59  26.3 yes     199\n19 20-39  35.3 no      218\n20 60-99  25.5 yes     206\n21 20-39  26.3 no      187\n22 20-39  33.2 no      229\n23 20-39  27.5 no      131\n24 60-99  24.9 no      186\n25 40-59  27.4 no      186\n```\n\n\n:::\n:::\n\n\n### Compare imputed values\n\nIf you want to compare the imputed values in a more direct way, we can use the broad format to do that on a variable by variable basis. Here I will ask to look at just **bmi**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomplete(imp, \"broad\", include = T) |> \n  select(contains(\"bmi\")) |> tibble() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `age` -> `age...1`\n• `bmi` -> `bmi...2`\n• `hyp` -> `hyp...3`\n• `chl` -> `chl...4`\n• `age` -> `age...5`\n• `bmi` -> `bmi...6`\n• `hyp` -> `hyp...7`\n• `chl` -> `chl...8`\n• `age` -> `age...9`\n• `bmi` -> `bmi...10`\n• `hyp` -> `hyp...11`\n• `chl` -> `chl...12`\n• `age` -> `age...13`\n• `bmi` -> `bmi...14`\n• `hyp` -> `hyp...15`\n• `chl` -> `chl...16`\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 4\n   bmi.0 bmi.1 bmi.2 bmi.3\n   <dbl> <dbl> <dbl> <dbl>\n 1  NA    30.1  22.5  27.2\n 2  22.7  22.7  22.7  22.7\n 3  NA    22    25.5  26.3\n 4  NA    22.7  27.4  21.7\n 5  20.4  20.4  20.4  20.4\n 6  NA    25.5  21.7  21.7\n 7  22.5  22.5  22.5  22.5\n 8  30.1  30.1  30.1  30.1\n 9  22    22    22    22  \n10  NA    27.4  22.7  25.5\n11  NA    33.2  22.5  28.7\n12  NA    22.7  25.5  27.5\n13  21.7  21.7  21.7  21.7\n14  28.7  28.7  28.7  28.7\n15  29.6  29.6  29.6  29.6\n16  NA    27.2  22.7  30.1\n17  27.2  27.2  27.2  27.2\n18  26.3  26.3  26.3  26.3\n19  35.3  35.3  35.3  35.3\n20  25.5  25.5  25.5  25.5\n21  NA    22    26.3  20.4\n22  33.2  33.2  33.2  33.2\n23  27.5  27.5  27.5  27.5\n24  24.9  24.9  24.9  24.9\n25  27.4  27.4  27.4  27.4\n```\n\n\n:::\n:::\n\n\n`bmi.0` is the original **bmi** data and the columns to its right are each of the three imputations for that variable. This provides an easy way to scan across and examine what `mice` has given us.\n\n## with()\n\nNow that we have imputed the data, we can use `with()` to analyse the data. Generally there is not much need to inspect the output of this step and we usually go straight onto pooling the results, but for the sake of the exercise we will take a closer look at the `mira` object that is generated. So, let's run the regression model that we specified earlier, with **bmi** as the outcome and **age**, **hyp** and **chl** as predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_imp <- with(imp, lm(bmi ~ age + hyp + chl))\nsummary(fit_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 × 6\n   term        estimate std.error statistic    p.value  nobs\n   <chr>          <dbl>     <dbl>     <dbl>      <dbl> <int>\n 1 (Intercept)  20.3       3.22        6.29 0.00000386    25\n 2 age40-59     -4.74      1.97       -2.41 0.0260        25\n 3 age60-99     -5.13      2.08       -2.46 0.0229        25\n 4 hypyes        2.36      1.79        1.32 0.203         25\n 5 chl           0.0420    0.0176      2.39 0.0266        25\n 6 (Intercept)  16.1       3.57        4.51 0.000214      25\n 7 age40-59     -4.11      1.86       -2.22 0.0385        25\n 8 age60-99     -5.11      1.93       -2.64 0.0156        25\n 9 hypyes        2.00      1.80        1.11 0.279         25\n10 chl           0.0602    0.0200      3.01 0.00687       25\n11 (Intercept)  21.8       3.74        5.84 0.0000104     25\n12 age40-59     -3.03      1.77       -1.71 0.103         25\n13 age60-99     -5.19      1.85       -2.81 0.0108        25\n14 hypyes        1.88      1.88        1.00 0.328         25\n15 chl           0.0306    0.0198      1.55 0.138         25\n```\n\n\n:::\n:::\n\n\nSee how we obtain the regression output for each imputed dataset stacked one on top of the other in a single dataframe. This allows us to quickly compare the estimated regression parameters across imputations.\n\n## pool()\n\nWe can now call `pool()` to pool the results of the separate regressions based on Rubin's rules.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pool(fit_imp), conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 8\n  term        estimate std.error statistic    df p.value `2.5 %` `97.5 %`\n  <fct>          <dbl>     <dbl>     <dbl> <dbl>   <dbl>   <dbl>    <dbl>\n1 (Intercept)  19.4       4.90        3.96  4.48  0.0134  6.35     32.4  \n2 age40-59     -3.96      2.12       -1.87 10.5   0.0895 -8.65      0.728\n3 age60-99     -5.14      1.96       -2.63 18.2   0.0169 -9.25     -1.04 \n4 hypyes        2.08      1.84        1.13 17.7   0.274  -1.80      5.95 \n5 chl           0.0443    0.0258      1.72  5.01  0.146  -0.0219    0.110\n```\n\n\n:::\n:::\n\n\nNote that there is also a \"tidy\" way to format this output directly, using the `tbl_regression()` function, which provides for much nicer viewing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_imp |> \n  tbl_regression() |> \n  add_glance_source_note()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bsvemmnntr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bsvemmnntr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bsvemmnntr thead, #bsvemmnntr tbody, #bsvemmnntr tfoot, #bsvemmnntr tr, #bsvemmnntr td, #bsvemmnntr th {\n  border-style: none;\n}\n\n#bsvemmnntr p {\n  margin: 0;\n  padding: 0;\n}\n\n#bsvemmnntr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bsvemmnntr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bsvemmnntr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bsvemmnntr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bsvemmnntr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bsvemmnntr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bsvemmnntr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bsvemmnntr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bsvemmnntr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bsvemmnntr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bsvemmnntr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bsvemmnntr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bsvemmnntr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bsvemmnntr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bsvemmnntr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bsvemmnntr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bsvemmnntr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bsvemmnntr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bsvemmnntr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bsvemmnntr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bsvemmnntr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bsvemmnntr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bsvemmnntr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bsvemmnntr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bsvemmnntr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bsvemmnntr .gt_left {\n  text-align: left;\n}\n\n#bsvemmnntr .gt_center {\n  text-align: center;\n}\n\n#bsvemmnntr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bsvemmnntr .gt_font_normal {\n  font-weight: normal;\n}\n\n#bsvemmnntr .gt_font_bold {\n  font-weight: bold;\n}\n\n#bsvemmnntr .gt_font_italic {\n  font-style: italic;\n}\n\n#bsvemmnntr .gt_super {\n  font-size: 65%;\n}\n\n#bsvemmnntr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bsvemmnntr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bsvemmnntr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bsvemmnntr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bsvemmnntr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bsvemmnntr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bsvemmnntr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    20-39</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    40-59</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-4.0</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-8.7, 0.73</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.090</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    60-99</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-5.1</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-9.3, -1.0</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.017</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">hyp</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    no</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    yes</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.1</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-1.8, 6.0</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.3</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">chl</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.02, 0.11</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.15</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">nimp = 3.00; No. Obs. = 25; R² = 0.364; Adjusted R² = 0.236</td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Compare with CCA\n\nI will re-print the model output from the CCA so that we can compare it to the MI results:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(bmi ~ age + hyp + chl, data = nhanes2) |> \n  tbl_regression() |> \n  add_glance_source_note()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rzxkwsbxuy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rzxkwsbxuy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rzxkwsbxuy thead, #rzxkwsbxuy tbody, #rzxkwsbxuy tfoot, #rzxkwsbxuy tr, #rzxkwsbxuy td, #rzxkwsbxuy th {\n  border-style: none;\n}\n\n#rzxkwsbxuy p {\n  margin: 0;\n  padding: 0;\n}\n\n#rzxkwsbxuy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rzxkwsbxuy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rzxkwsbxuy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rzxkwsbxuy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rzxkwsbxuy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rzxkwsbxuy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rzxkwsbxuy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rzxkwsbxuy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rzxkwsbxuy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rzxkwsbxuy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rzxkwsbxuy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rzxkwsbxuy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rzxkwsbxuy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rzxkwsbxuy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rzxkwsbxuy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rzxkwsbxuy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rzxkwsbxuy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rzxkwsbxuy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rzxkwsbxuy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rzxkwsbxuy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rzxkwsbxuy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rzxkwsbxuy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rzxkwsbxuy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rzxkwsbxuy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rzxkwsbxuy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rzxkwsbxuy .gt_left {\n  text-align: left;\n}\n\n#rzxkwsbxuy .gt_center {\n  text-align: center;\n}\n\n#rzxkwsbxuy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rzxkwsbxuy .gt_font_normal {\n  font-weight: normal;\n}\n\n#rzxkwsbxuy .gt_font_bold {\n  font-weight: bold;\n}\n\n#rzxkwsbxuy .gt_font_italic {\n  font-style: italic;\n}\n\n#rzxkwsbxuy .gt_super {\n  font-size: 65%;\n}\n\n#rzxkwsbxuy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rzxkwsbxuy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rzxkwsbxuy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rzxkwsbxuy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rzxkwsbxuy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rzxkwsbxuy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rzxkwsbxuy .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    20-39</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    40-59</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-6.6</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-12, -1.3</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.021</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    60-99</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-11</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-19, -3.4</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.010</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">hyp</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    no</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    yes</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2.4</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-3.5, 8.2</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.4</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">chl</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.08</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">0.02, 0.14</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.012</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">R² = 0.670; Adjusted R² = 0.505; Sigma = 3.23; Statistic = 4.06; p-value = 0.044; df = 4; Log-likelihood = -30.6; AIC = 73.1; BIC = 76.5; Deviance = 83.7; Residual df = 8; No. Obs. = 13</td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nThere are certainly some differences in the regression coefficients - most notable for **age**. Interestingly **age** had no missingness in the original data, so MI is likely facilitating more accurate estimation of the age parameters given we are able to utilise all of the available data by not throwing almost half of it away (as in the CCA). Obviously we cannot say with certainty what the true population parameters are, as these are not simulated data, but it would be reasonable to assume that MI provides a more valid (less biased) analysis.\n\n# Conclusion\n\nI think that's probably more than enough for this post. What we have covered today are really just the basics of MI using `mice`. You have no doubt surmised by now that missing data is a fairly complex topic in applied biostatistics, and one that extends into more advanced areas that we haven't even considered in these posts. There are many other considerations in MI, including:\n\n-   How to impute derived variables (e.g. ratios, interaction terms, quadratic terms, etc).\n\n-   How to impute for multilevel (repeated measures) models.\n\n-   How to predict after MI (this is not straightforward).\n\nA good starting point if you want to do more reading on missing data and MI is Stef van Buuren's \"bible\" on the topic - \"Flexible Imputation of Missing Data\". A free online version is available at <https://stefvanbuuren.name/fimd/>. It is well worth bookmarking as a reference text to help you in your missing data analysis endeavours. A paper that goes in some way to addressing the final issue of prediction can be found [here](https://journals.sagepub.com/doi/abs/10.1177/0049124115610345) and is also worth checking out.\n\nOk team, I hope you have found these posts useful. Until next time...\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}